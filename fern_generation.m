clear
clc
clf

x0 = [0;0];

N = 1e6;
P = [0.01,0.85,0.07,0.07];
f1 = 1-P(1);
f2 = f1-P(2);
f3 = f2-P(3);
x = zeros(N+1,1);
y = x;

a = [0.00  0.85  0.20 -0.15];
b = [0.00  0.04 -0.26  0.28];
c = [0.00 -0.04  0.23  0.26];
d = [0.16  0.85  0.22  0.24];
e = [0.00  0.00  0.00  0.00];
f = [0.00  1.40  1.40  0.44];

A1 = [a(1),b(1);c(1),d(1)];
B1 = [e(1);f(1)];

A2 = [a(2),b(2);c(2),d(2)];
B2 = [e(2);f(2)];

A3 = [a(3),b(3);c(3),d(3)];
B3 = [e(3);f(3)];

A4 = [a(4),b(4);c(4),d(4)];
B4 = [e(4);f(4)];


for k = 1:N
    
    m = rand;
    if m > f1
        x0 = A1*x0+B1;
    elseif m > f2
        x0 = A2*x0+B2;
    elseif m > f3
        x0 = A3*x0+B3;
    else
        x0 = A4*x0+B4;
    end
            
    x(k) = x0(1);
    y(k) = x0(2);
    
end

plot(x,y,'.')
axis equal